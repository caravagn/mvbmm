<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Variational fit for Binomial mixtures — variational_fit • VIBER</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Variational fit for Binomial mixtures — variational_fit"><meta property="og:description" content="Variational fit for a semi-parametric Dirichelt mixture of Binomial
distributions. The fit convergency can be monitored through the ELBO,
can be run either sequentially (single core) or in parallel. You need
to provide an upper bound on the number of clusters that you want to
obtain, through parameters K. You can explicit the Dirichlet
prior for the concentration of the mixture (alpha_0), as well as
the hyperparmeters of the Beta priors for each mixture component."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">VIBER</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/VIBER.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/caravagnalab/VIBER/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Variational fit for Binomial mixtures</h1>
    <small class="dont-index">Source: <a href="https://github.com/caravagnalab/VIBER/blob/HEAD/R/variational_fit.R" class="external-link"><code>R/variational_fit.R</code></a></small>
    <div class="hidden name"><code>variational_fit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Variational fit for a semi-parametric Dirichelt mixture of Binomial
distributions. The fit convergency can be monitored through the ELBO,
can be run either sequentially (single core) or in parallel. You need
to provide an upper bound on the number of clusters that you want to
obtain, through parameters <code>K</code>. You can explicit the Dirichlet
prior for the concentration of the mixture (<code>alpha_0</code>), as well as
the hyperparmeters of the Beta priors for each mixture component.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">variational_fit</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  K <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  alpha_0 <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  a_0 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  b_0 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  epsilon_conv <span class="op">=</span> <span class="fl">1e-10</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  q_init <span class="op">=</span> <span class="st">"prior"</span>,</span>
<span>  trace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"My VIBER model"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A matrix where each column is a dimension of the multivariate Binomial,
and each row is an input point. Values of this matrix represent the number of
successes of independent Bernoulli trials. This matrix and <code>y</code> should have
the same dimension  (<code>N x K</code>, <code>N</code> points, <code>K</code> dimensions).</p></dd>


<dt>y</dt>
<dd><p>A matrix where each column is a dimension of the multivariate Binomial,
and each row is an input point. Values of this matrix represent the number of
attempts of independent Bernoulli trials. This matrix and <code>x</code> should have
the same dimension  (<code>N x K</code>, <code>N</code> points, <code>K</code> dimensions).</p></dd>


<dt>data</dt>
<dd><p>Extra data.frame  (<code>N x K</code>, <code>N</code> points, <code>W</code> attributes)
to store inside the output object <code>W</code> annotations for each one of the
<code>N</code> input points. This parameter can also be <code>NULL</code>, in this case
there is no extra annotation associated to the input. The annotations are necessary
if one seeks to use VIBER to analyse cancer multi-sample sequencing data (the
Binomial counts are  in that case <em>"cancer sequencing read counts"</em>); in that
case in the annotations there must be two columns, <code>gene</code> and <code>driver</code>
reporting a gene identifier for the input mutation, and its boolean driver status.
The extra annotation data will be stored in the <code>data</code> field of the output.</p></dd>


<dt>K</dt>
<dd><p>The maximum number of clusters returned, it should be lower than the
number of rows of <code>x</code> and <code>y</code>. Default is <code>K = 10</code>; lower values
speed up convergence.</p></dd>


<dt>alpha_0</dt>
<dd><p>The concentration parameter of the Dirichlet mixture. The default
is a stringent fit with <code>alpha = 1e-6</code>.</p></dd>


<dt>a_0</dt>
<dd><p>Prior Beta hyperparameter. If this values is a scalar than all the
mixture components have the same prior. The default is scalar  <code>a_0 = 1</code>.</p></dd>


<dt>b_0</dt>
<dd><p>Prior Beta hyperparameter. If this values is a scalar than all the
mixture components have the same prior. The default is scalar  <code>b_0 = 1</code>.</p></dd>


<dt>max_iter</dt>
<dd><p>Maximum number of fit iterations. The fit is interrupted when
this number of iterations is performed. Default <code>max_iter = 5000</code></p></dd>


<dt>epsilon_conv</dt>
<dd><p>Epsilon to measure convergence (ELBO absolute difference).</p></dd>


<dt>samples</dt>
<dd><p>Number of fits computed by the algorithm. Only the best fit is
returned. This value must be greater or equal than 1.</p></dd>


<dt>q_init</dt>
<dd><p>Initialization of the q-distribution to compute the approximation
of the posterior distributions. This can be set in three different waysL
equal to the prior (<code>q_init = 'prior'</code>), via kmeans clustering
(<code>q_init = 'kmeans'</code>) and capturing points which are private to each
dimension (<code>q_init = 'private'</code>). The default is equal to the prior.</p></dd>


<dt>trace</dt>
<dd><p>If true the trace computed during the fit is returned (this allows
to check fits a posterirori, make animations etc.). Default is <code>FALSE</code>; this
feature can slow down quite substantially the fit.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>vb_bmm</code> which contains S3 methods to extract
the fit, plots the results, compute summary statistics etc.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mvbmm_example</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">=</span> <span class="fu">variational_fit</span><span class="op">(</span><span class="va">mvbmm_example</span><span class="op">$</span><span class="va">successes</span>, <span class="va">mvbmm_example</span><span class="op">$</span><span class="va">trials</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBBBB; background-color: #0000BB;"> [ VIBER - variational fit ] </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Input n = 231, with k &lt; 10. Dirichlet concentration <span style="color: #00BB00;">α = 1e-06</span>.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Beta (a_0, b_0) = (1, 1); q_i = prior. Optimise: ε = 1e-10 or 5000 steps, r = 10 starts.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> <span style="font-weight: bold;">VIBER fit</span> completed in 0.09 mins (status: <span style="color: #00BB00;">converged</span>)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="color: #000000; background-color: #BBBB00;">[ VIBER ] My VIBER model</span> n = 231 (w = 2 dimensions). Fit with <span style="color: #00BB00;">k = 10</span> clusters</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Clusters: π = 45% [<span style="color: #BBBB00;">C9</span>], 28% [<span style="color: #BBBB00;">C4</span>], 20% [<span style="color: #BBBB00;">C1</span>], and 7% [<span style="color: #BBBB00;">C10</span>], with π &gt; 0.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Binomials: θ = &lt;0.5, 0.49&gt; [<span style="color: #BBBB00;">C9</span>], &lt;0, 0.2&gt; [<span style="color: #BBBB00;">C4</span>], &lt;0.25, 0.25&gt; [<span style="color: #BBBB00;">C1</span>], and &lt;0.22,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0&gt; [<span style="color: #BBBB00;">C10</span>].</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Score(s): ELBO = -47073.31. Fit <span style="color: #00BB00;">converged</span> in 21 steps, ε = 1e-10.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="color: #000000; background-color: #BBBB00;">[ VIBER ] My VIBER model</span> n = 231 (w = 2 dimensions). Fit with <span style="color: #00BB00;">k = 10</span> clusters</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Clusters: π = 45% [<span style="color: #BBBB00;">C9</span>], 28% [<span style="color: #BBBB00;">C4</span>], 20% [<span style="color: #BBBB00;">C1</span>], and 7% [<span style="color: #BBBB00;">C10</span>], with π &gt; 0.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Binomials: θ = &lt;0.5, 0.49&gt; [<span style="color: #BBBB00;">C9</span>], &lt;0, 0.2&gt; [<span style="color: #BBBB00;">C4</span>], &lt;0.25, 0.25&gt; [<span style="color: #BBBB00;">C1</span>], and &lt;0.22,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0&gt; [<span style="color: #BBBB00;">C10</span>].</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Score(s): ELBO = -47073.31. Fit <span style="color: #00BB00;">converged</span> in 21 steps, ε = 1e-10.</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Giulio Caravagna.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer></div>

  


  

  </body></html>

